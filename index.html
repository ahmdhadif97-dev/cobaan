import { useState, useRef, useEffect } from "react";

export default function NumberScroller() {
  const [numbers] = useState(
    Array.from({ length: 100 }, (_, i) => (i + 1).toString().padStart(4, "0"))
  );
  const scrollerRef = useRef(null);
  const [centerNumber, setCenterNumber] = useState("0001");

  // Track which number is centered
  const handleScroll = () => {
    if (scrollerRef.current) {
      const { scrollTop, clientHeight } = scrollerRef.current;
      const centerPos = scrollTop + clientHeight / 2;
      const itemIndex = Math.floor(centerPos / 50); // 50px per item
      const newCenter = numbers[itemIndex];
      if (newCenter && newCenter !== centerNumber) {
        setCenterNumber(newCenter);
      }
    }
  };

  // Initialize to show 0001 centered with 0002-0004 below
  useEffect(() => {
    if (scrollerRef.current) {
      scrollerRef.current.scrollTo({
        top: 0,
        behavior: "auto"
      });
      scrollerRef.current.addEventListener("scroll", handleScroll);
      return () => scrollerRef.current.removeEventListener("scroll", handleScroll);
    }
  }, []);

  return (
    <div style={styles.container}>
      <div 
        ref={scrollerRef} 
        style={styles.scroller}
        onScroll={handleScroll}
      >
        {/* Add padding to properly center first and last items */}
        <div style={{ height: "150px" }}></div>
        
        {numbers.map((num) => (
          <div 
            key={num}
            data-value={num}
            style={{
              ...styles.number,
              ...(num === centerNumber && styles.centerNumber)
            }}
          >
            {num}
          </div>
        ))}
        
        <div style={{ height: "150px" }}></div>
      </div>
    </div>
  );
}

const styles = {
  container: {
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    height: "100vh",
    backgroundColor: "#f5f5f5"
  },
  scroller: {
    height: "350px",
    width: "100px",
    overflowY: "scroll",
    scrollSnapType: "y mandatory",
    scrollbarWidth: "thin",
    fontFamily: "'Roboto Mono', monospace",
    position: "relative"
  },
  number: {
    height: "50px",
    display: "flex",
    justifyContent: "center",
    alignItems: "center",
    scrollSnapAlign: "center",
    color: "#999",
    fontSize: "14px",
    transition: "all 0.2s ease"
  },
  centerNumber: {
    color: "#000",
    fontSize: "18px",
    fontWeight: "bold",
    transform: "scale(1.1)"
  }
};
